---
title: "Homework #3"
author: "Yefrid Cordoba"
format: html
editor: visual
---

## Problem 1

A regression analysis relating test scores (Y) to training hours (X) produced the following fitted equation: $\hat{y}= 25 ‚àí 0.5x$.

### a.

What is the fitted value of the response variable corresponding to $ x = 7$?

**R/**\

```{r}
y = 25 - 0.5 * 7
y
```

The fitted value when x = 7 is y = 21.5

### b.

What is the residual corresponding to the data point with ùë• = 3 and ùë¶ = 30?.\
Is the point above or below the line? Why?

**R/**\

```{r}
y_hat = 25 - 0.5 * 3
y_hat
30-y_hat
```

The residual is 6.5, it is above the line due to the positive error, because after evaluating the fitted equation with 3, the $\hat{y}$ is lower than the y corresponding to the data point.

### c.

If x increases 3 units, how does $\hat{y}$ change?

**R/**\

```{r}
-0.5 * 3
```

It x increase 3 units, the estimated value y will decrease 1.5 units.

### d.

An additional test score is to be obtained for a new observation at ùë• = 6.\
Would the test score for the new observation necessarily be 22? Explain.

**R/**\
Not necessarily, this is because there is a probability associated to each point on the regression that is assumed to be normal, to determine what is the range at which we can be sure about the true future value of y when x = 6, we would need to estimate the prediction interval.

### e.

The error sums of squares (SSE) for this model were found to be 7. If there were n = 16 observations, provide the best estimate for $\sigma^2$.

**R/**\

```{r}
SSE = 7
n = 16
p = 2 #2 parameters estimated in the model b0 and b1
s2 = SSE / (n - 2)
s2
```

The best estimate is $\sigma^2 = 0.5$.

## Problem 2

The dataset "Healthy Breakfast" contains, among other variables, the Consumer Reports ratings of 77 cereals and the number of grams of sugar contained in each serving. Considering "Sugars" as the explanatory variable and "Rating" as the response variable generated the following fitted regression equation: $$ \widehat{rating} = 59.3 - 2.4 * sugars$$ The "Analysis of variance" partial portion of the R output is shown below

### a.

Find the missing values

| Source | DF | SS | MS | F | P |
|:----------:|:----------:|:----------:|:----------:|:----------:|:----------:|
| **Regression** | [1]{.underline} | 8654.7 | [8654.7]{.underline} | [102.35]{.underline} | [1.1537e-15]{.underline} |
| **Error** | [75]{.underline} | [6342.1]{.underline} | [84.56]{.underline} |  |  |
| **Total** | [76]{.underline} | 14996.8 |  |  |  |

```{r}
nt <- 77
SSr <- 8654.7
MSr <- 8654.7
SST <- 14996.8
dfr <- SSr / MSr
dfr
SSE <- SST - SSr
SSE
p <- dfr + 1
p
dfe <- nt-p
dfe
dfT <- dfe + dfr
dfT
MSE <- SSE / dfe
MSE
F_v <- MSr / MSE
F_v
P_v <- pf(F_v, dfr, dfe, lower.tail = F)
P_v
```

### b.

Find $R^2$ value and interpret that number.

**R/**\

```{r}
R_sq <- SSr / SST
R_sq
```

Based on our $R^2$, 57% of the variability of the data can be explained by the model.

### c.

What is the estimated value of $\sigma^2$.

**R/**\

```{r}
s2 = SSE / (nt - p)
s2
```

The estimated variance is $\sigma^2 = 84.56$.

### d.

Test $H_o : \beta_1 = 0$ against $H_a : \beta_1 \neq 0$ using F - test

**R/**\
Assuming a 5% level of significance, and given that the P-value (1.1537e-15)from the table is much lower than our level of significance, we reject the null hypothesis and have strong evidence to conclude that $\beta_1$ is different than 0.

## Problem 3

Athletes are constantly seeking measures of the degree of their cardiovascular fitness prior to a major race. Athletes want to know when their training is at a level that will produce a peak performance. One such measure of fitness is the time to exhaustion from running on a treadmill at a specified angle and speed. The important question is then ‚ÄúDoes this measure of cardiovascular fitness translate into performance in a 10-km running race?‚Äù Twenty experienced distance runners who professed to be in top condition were evaluated on the treadmill and then had their times recorded in a 10-km race.

You are provided with the following information $$ \hat{\beta_0} = b_0 = 58.816$$ $$ \hat{\beta_1} = b_1 = -1.867$$ $$ s(b_1) = 0.346$$ $$ MSE = 4.417$$ $$\hat{y}= 58.816 ‚àí 1.867x$$ \### a.

Test the hypothesis that there is a linear relationship between the amount of time needed to run a 10-km race and the time to exhaustion on a treadmill.

**R/**\

```{r}
bo <- 58.816
b1 <- -1.867
MSE <- 4.417
sb1 <- 0.346
tobs <- (b1 - 0) / sb1
tobs < -qt(0.975, 18)
```

We have to test:$H_o : \beta_1 = 0$ against $H_a : \beta_1 \neq 0$

Assuming an $\alpha = 0.05$, and knowing that $t_{obs} < -t_{(0.975, 18)}$ we reject the null hypothesis and conclude that the time of exhaustion on a treadmill has a linear relationship to the time needed to run a 10-km race.

### b.

Construct a 95% confidence interval for $\beta_1$.

**R/**\

```{r}
Up <- b1 + qt(0.975, 18) *sb1
Up
Lo <- b1 - qt(0.975, 18) *sb1
Lo
```

We are 95% confident that the estimated mean time to run a 10-km race decreases between 1.14 and 2.59 minutes for each additional minute that an athlete times on the treadmill.

### c.

Construct a 95% confidence interval for the estimated mean 10-km race when the treadmill time is 10 minutes. Given that $sd${ $\hat{y}_{x_h=10}$} $= 0.7342$

**R/**\

```{r}
y_hat <- bo + b1 * 10
y_hat
sd10 <- 0.7342
Up10 <- y_hat + sd10 * qt(0.975, 18)
Up10
Lo10 <- y_hat - sd10 * qt(0.975, 18)
Lo10
```

We are 95% confident that the estimated mean time when the treadmill time is 10 min for a 10-km race is between 38.6 and 41.7 minutes.

### d.

Construct a 95% prediction interval for an athlete whose treadmill time is 10 minutes. $sd(\hat{y}_{\text{pred}}) = \sqrt{mse + \left(sd\{\hat{y}_{x_h = 10}\}\right)^2} = 2.226$

```{r}
sdpred <- 2.226
Upp <- y_hat + sdpred * qt(0.975, 18)
Upp
Lop <- y_hat - sdpred * qt(0.975, 18)
Lop
```

We are 95% confident that the mean time when an athlete times 10 min on the treadmill will be between 35.5 and 44.8 min for a 10-km race.

## Problem 4

The director of admissions of a small college selected 120 students at random from the new freshman class in a study to determine whether a student's grade point average (GPA) at the end of the freshman year (Y) can be predicted from the ACT test score (X). The results of the study follow. Assume that first-order regression model $Y_i = \beta_0 + \beta_1 * X_i + \epsilon_i$ is appropriate. **(Data is provided in the Moodle Page)**

```{r}
gpa_data<-read.table('Homework3 Data.txt', header=T)
names(gpa_data)
head(gpa_data)
tail(gpa_data)
attach(gpa_data)
```

### a.

Compute the mean and variance of ACT test score and GPA.

**R/**\

```{r}
#| message: false
#| warning: false
library(tidyverse)
gpa_data |>
  summarise(across(
    where(is.numeric),
    list(mean = mean, var = var),
    na.rm = TRUE
  ))
```

### b.

Compute the correlation between ACT test score and GPA. Comment on the strength and direction of the linear relationship between the variables.

**R/**
```{r}
cor(gpa_data$ACT, gpa_data$GPA, method = "pearson")
```
There is a positive correlation between ACT test score and GPA, that means that a higher test score is related to a higher GPA at the end of the  freshman year but this correlation is weak.

### c.

Construct a scatter plot. Is the relationship approximately linear?

**R/**
```{r}
gpa_data |>
  ggplot(aes(x = ACT, y = GPA)) +
  labs(x = 'ACT test score',
       y = 'GPA',
       title = 'Scatterplot of ACT test score vs. GPA at the end of freshman year')+
  theme_light() +
  geom_point()
```
The relationship for ACT test score and GPA is weakly positive and linear.

### d.

Run a linear regression to predict GPA based on the ACT score. Give the regression equation.

**R/**
```{r}
model <- lm(GPA ~ ACT, gpa_data)
summary(model)
```
The regression equation for this model is:

$$\widehat{GPA} = 2.11405 + 0.03883 * ACT_{testscore}$$

### e.

What is the point estimate of the change in the mean response when the entrance test score increases by one point? And increases by 4 points?

**R/**\
The estimated change in the mean GPA is 0.03883 points more when the ACT test score increases by one point
```{r}
0.03883*4
```
When the ACT test score increases by 4 points, it is estimated that the mean GPA at the end of the freshman year will be 0.15532 points higher.

### f.

Based on your answer in (e), predict the GPA of a student who scored 20 on the ACT.

**R/**\
```{r}
GPA20 <- 2.11405 + 0.03883 * 20
GPA20
```
The predicted mean GPA for a student who scored 20 on the ACT is 2.89.

### g.

Estimate $\sigma^2$ and $\sigma$

**R/**\
From the regression model we get $\sqrt{MSE} = 0.6231$ = standard error\
$\sigma^2 = MSE$
```{r}
MSE <- 0.6231 ^2
MSE
```
Estimates:

$$\sigma^2 = 0.3883$$
$$\sigma = 0.6231$$

### h.

Give a point estimate and 95% confidence interval for the slope and interpret each of these in words.

```{r}
confint(model, 'ACT', level = 0.95)
```
Point estimate = 0.03883\
For each point increase in the ACT test score, it is estimated that the GPA will increase by 0.03883 points.

We are 95% confident that the true change in the GPA for each ACT test point obtained by the students is between 0.0135 and 0.0641 more.

### i.

Obtain a 95% interval estimate of the mean GPA for students whose ACT test score is 28. Interpret your confidence interval.

**R/**\
```{r}
data <- data.frame(ACT = 28)
predict(model, data, interval = 'confidence', 
        level = 0.95, se.fit = TRUE)
```
We are 95% confident that the true mean GPA value is between 3.061 and 3.341 when the ACT test score is 28.

### j.

Predict GPA using a 95% prediction interval for students whose ACT test score is 28.

**R/**
```{r}
data <- data.frame(ACT = 28)
predict(model, data, interval = 'prediction', 
        level = 0.95, se.fit = TRUE)
```
For students with an ACT score of 28, a 95% prediction interval for freshman year GPA is 1.959 to 4.443, meaning that under similar conditions about 95% of those students‚Äô GPAs are expected to fall in this range.

## Problem 5

A medical study was conducted to study the relationship between infants‚Äô systolic blood pressure and two explanatory variables, weight (kgm) and age (days). The portion of data for 25 infants are shown here.

```{r}
age <- c(3, 4, 5, 6, 3, 4, 5, 6, 3, 4, 5, 6, 3, 4, 5, 6, 3, 4, 5, 6, 3, 4, 5, 6, 6) 
weight <- c(2.61, 2.67, 2.98, 3.98, 2.87, 3.41, 3.49, 4.03, 3.41, 2.81, 3.24, 3.75, 3.18, 3.13, 3.98, 4.55, 3.41, 3.35, 3.75, 3.83, 3.18, 3.52, 3.49, 3.81, 4.03) 
systolic_BP <- c(80, 90, 96, 102, 81, 96, 99, 110, 88, 90, 100, 102, 86, 93, 101, 103, 86, 91, 100, 105, 84, 91, 95, 104, 107) 
# Create a data frame 
data <- data.frame(age, weight, systolic_BP)
```

### a.

Write a first-order multiple regression model relating Systolic BP to Age and Weight.

**R/**
$$\widehat{Systolic BP} = \beta_0 + \beta_1 * Age + \beta_2 * Weight$$

### b.

Fit Multiple linear regression models to these data and obtain the estimated regression equation.

**R/**
```{r}
MLRmodel <- lm(systolic_BP ~ age + weight, data)
summary(MLRmodel)
```
The estimated multiple linear regression model is:

$$\widehat{Systolic BP} = 57.2644 + 5.8041 * Age + 3.3162 * Weight$$

### c.

Obtain the estimated residual standard deviation.

**R/**\
The estimated residual standard error = estimated residual standard deviation.

$$\sigma = \sqrt{MSE} = 2.454 $$

### d.

Provide an interpretation of $\hat{\beta_2}$, the coefficient of weight.

**R/**\
If the age of an infant is constant, for each additional kilogram of weight that an infant has, the mean systolic blood pressure will increase by 3.32.

### e.

Can the hypothesis of no overall predictive value of the model be rejected at the $\alpha = 0.01$ level?

**R/**\
Given the p-value(8.696e-13) obtained for the overall predictive value of the model is much lower than the significance level, it is valid to reject the hypothesis that the model has no overall predictive power on the systolic blood preassure of infants.